<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<!-- generated by to_html.pl from GModule.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS" />
	<title>GModuleについて</title>
	<meta name="author" content="Halo" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里関連リファレンス用標準スタイル" />
	<link href="mailto:halosuke@gmail.com" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="トップページ" />
</head>
<body>
<h1><a id="id84" name="id84">GModuleオブジェクト</a>
</h1><div class="para"><div>
　KAG3で言うところのPluginクラスはGOKI2ではGModuleクラスが該当します。<br />
　GModuleを作成するにはまず、クラス名.tjsのファイルを作成します。<br />
　Sample.tjsを作成し内容を以下のようにします。<br />
　createExtensionTagHandlersメソッドを実装して辞書配列を返す事でタグを追加できます。<br />
<div class="tagexample"><code class="bq"><span class="weak">Sample.tjs</span><br />
class Sample extends GModule<br />
{<br />
　function Sample(container, name)<br />
　{<br />
　　super.GModule(container, name);<br />
　}<br />
<br />
　function createExtensionTagHandlers()<br />
　{<br />
　　return %[<br />
　　　/* @sample */<br />
　　　'sample' =&gt; function (elm, c) {<br />
　　　　// cは実行元のコンダクタが渡されます。<br />
　　　　System.inform("sampleタグを実行しました。");<br />
　　　} incontextof this,<br />
　　];<br />
　}<br />
}<br />
</code></div>
<br />
　Sample.tjsを作成後construct.gsファイルに以下の一行を追加します。<br />
<div class="tagexample"><code class="bq">
@load_module name=Sample<br />
</code></div>
<br />
　これでsampleタグを書く事ができるようになります。<br />
<br />
<h1><a id="id84" name="id84">イベント</a>
</h1><div class="para"><div>
GOKI2のモジュールは様々なイベントを受け取る事ができます。<br />
例としてウインドウの左クリックイベントを受け取る場合Sampleクラスに以下を追加します。<br />
<div class="tagexample"><code class="bq"><span class="weak">Sample.tjs</span><br />
class Sample extends GModule<br />
{<br />
　function onWindowLeftClick(x, y, shift)<br />
　{<br />
　　// ウインドウ左クリックされたので何か処理を書く。<br />
　}<br />
}<br />
</code></div>
<table class="taglist"><tbody>
<tr><td class="taglisteven"><span class="taglistlink"><a class="jump" href="#onConductorCall">onConductorCall</a></span></td><td class="taglisteven">callタグ実行イベント</td></tr>
<tr><td class="taglistodd"><span class="taglistlink"><a class="jump" href="#onConductorJump">onConductorJump</a></span></td><td class="taglistodd">jumpタグ実行イベント</td></tr>
<tr><td class="taglisteven"><span class="taglistlink"><a class="jump" href="#onConductorReturn">onConductorReturn</a></span></td><td class="taglisteven">returnタグ実行イベント</td></tr>
<tr><td class="taglistodd"><span class="taglistlink"><a class="jump" href="#onConductorScenarioLoad">onConductorScenarioLoad</a></span></td><td class="taglistodd">シナリオのロードイベント</td></tr>
<tr><td class="taglisteven"><span class="taglistlink"><a class="jump" href="#onConductorScenarioLoaded">onConductorScenarioLoaded</a></span></td><td class="taglisteven">シナリオのロード後イベント</td></tr>
<tr><td class="taglistodd"><span class="taglistlink"><a class="jump" href="#onConductorLabel">onConductorLabel</a></span></td><td class="taglistodd">ラベル通過イベント</td></tr>
<tr><td class="taglisteven"><span class="taglistlink"><a class="jump" href="#onSoundMasterVolumeChanged">onSoundMasterVolumeChanged</a></span></td><td class="taglisteven">サウンドのマスターボリューム変更イベント</td></tr>
<tr><td class="taglistodd"><span class="taglistlink"><a class="jump" href="#onWindowLeftClick">onWindowLeftClick</a></span></td><td class="taglistodd">ウインドウの左クリックイベント</td></tr>
<tr><td class="taglisteven"><span class="taglistlink"><a class="jump" href="#onWindowRightClick">onWindowRightClick</a></span></td><td class="taglisteven">ウインドウの右クリックイベント</td></tr>
<tr><td class="taglistodd"><span class="taglistlink"><a class="jump" href="#onWindowMiddleClick">onWindowMiddleClick</a></span></td><td class="taglistodd">ウインドウの中ボタンクリックイベント</td></tr>
<tr><td class="taglistodd"><span class="taglistlink"><a class="jump" href="#onWindowMouseWheel">onWindowMouseWheel</a></span></td><td class="taglistodd">ウインドウのホイールイベント</td></tr>
<tr><td class="taglisteven"><span class="taglistlink"><a class="jump" href="#onWindowKeyDown">onWindowKeyDown</a></span></td><td class="taglisteven">キーダウンイベント</td></tr>
<tr><td class="taglistodd"><span class="taglistlink"><a class="jump" href="#onWindowKeyUp">onWindowKeyUp</a></span></td><td class="taglistodd">キーアップイベント</td></tr>
<tr><td class="taglisteven"><span class="taglistlink"><a class="jump" href="#onWindowClose">onWindowClose</a></span></td><td class="taglisteven">ウインドウクローズイベント</td></tr>
</tbody></table>
</div></div>

<h1><a name="onConductorCall" id="onConductorCall" class="targanchor"><span class="b">onConductorCall(elm)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onConductorCall"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">elm</td><td class="tagattribname">タグに渡された引数が辞書配列形式で渡されます。<br />
tagname : 'call'<br />
ignore : trueまたはfalseを指定します。trueを指定するとタグは無視されます。</td></tr>
</table>
</div></div>

<h1><a name="onConductorJump" id="onConductorJump" class="targanchor"><span class="b">onConductorJump(elm)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onConductorJump"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">elm</td><td class="tagattribname">タグに渡された引数が辞書配列形式で渡されます。<br />
tagname : 'jump'<br />
ignore : trueまたはfalseを指定します。trueを指定するとタグは無視されます。</td></tr>
</table>
</div></div>

<h1><a name="onConductorReturn" id="onConductorReturn" class="targanchor"><span class="b">onConductorReturn(elm)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onConductorReturn"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">elm</td><td class="tagattribname">タグに渡された引数が辞書配列形式で渡されます。<br />
tagname : 'return'<br />
ignore : trueまたはfalseを指定します。trueを指定するとタグは無視されます。</td></tr>
</table>
</div></div>

<h1><a name="onConductorScenarioLoad" id="onConductorScenarioLoad" class="targanchor"><span class="b">onConductorScenarioLoad(storage)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onConductorScenarioLoad"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">storage</td><td class="tagattribname">読み込まれるシナリオストレージ名。</td></tr>
</table>
</div></div>

<h1><a name="onConductorScenarioLoaded" id="onConductorScenarioLoaded" class="targanchor"><span class="b">onConductorScenarioLoaded(storage)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onConductorScenarioLoaded"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">storage</td><td class="tagattribname">読み込まれたシナリオストレージ名。</td></tr>
</table>
</div></div>

<h1><a name="onConductorLabel" id="onConductorLabel" class="targanchor"><span class="b">onConductorLabel(label, pagename, firstLabelProcessed)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onConductorLabel"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">label</td><td class="tagattribname">通過したラベル名。<td /></tr>
<tr><td class="tagattribalias">pagename</td><td class="tagattribname">通過したラベルのページ名。</td></tr>
<tr><td class="tagattribalias">firstLabelProcessed</td><td class="tagattribname">最初のセーブ可能ラベルを通過している場合はtrueが渡される。<td /></tr>
</table>
</div></div>

<h1><a name="onSoundMasterVolumeChanged" id="onSoundMasterVolumeChanged" class="targanchor"><span class="b">onSoundMasterVolumeChanged(newVol, oldVol)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onSoundMasterVolumeChanged"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">newVol</td><td class="tagattribname">新しく設定されたマスターボリューム値<td /></tr>
<tr><td class="tagattribalias">oldVol</td><td class="tagattribname">元のマスターボリューム値。</td></tr>
</table>
</div></div>

<h1><a name="onWindowLeftClick" id="onWindowLeftClick" class="targanchor"><span class="b">onWindowLeftClick(x, y, shift)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onWindowLeftClick"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">x</td><td class="tagattribname">マウスカーソル位置<td /></tr>
<tr><td class="tagattribalias">y</td><td class="tagattribname">マウスカーソル位置</td></tr>
<tr><td class="tagattribalias">shift</td><td class="tagattribname">同時に押されていたキー。</td></tr>
</table>
</div></div>

<h1><a name="onWindowRightClick" id="onWindowRightClick" class="targanchor"><span class="b">onWindowRightClick(x, y, shift)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onWindowRightClick"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">x</td><td class="tagattribname">マウスカーソル位置<td /></tr>
<tr><td class="tagattribalias">y</td><td class="tagattribname">マウスカーソル位置</td></tr>
<tr><td class="tagattribalias">shift</td><td class="tagattribname">同時に押されていたキー。</td></tr>
</table>
</div></div>

<h1><a name="onWindowMiddleClick" id="onWindowMiddleClick" class="targanchor"><span class="b">onWindowMiddleClick(x, y, shift)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onWindowMiddleClick"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">x</td><td class="tagattribname">マウスカーソル位置<td /></tr>
<tr><td class="tagattribalias">y</td><td class="tagattribname">マウスカーソル位置</td></tr>
<tr><td class="tagattribalias">shift</td><td class="tagattribname">同時に押されていたキー。</td></tr>
</table>
</div></div>

<h1><a name="onWindowMouseWheel" id="onWindowMouseWheel" class="targanchor"><span class="b">onWindowMouseWheel(shift, delta, x, y)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onWindowMouseWheel"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">shift</td><td class="tagattribname">同時に押されていたキー。</td></tr>
<tr><td class="tagattribalias">delta</td><td class="tagattribname">上方向に回された場合は正、下方向に回された場合は負の値になります。</td></tr>
<tr><td class="tagattribalias">x</td><td class="tagattribname">マウスカーソル位置<td /></tr>
<tr><td class="tagattribalias">y</td><td class="tagattribname">マウスカーソル位置</td></tr>
</table>
</div></div>

<h1><a name="onWindowKeyDown" id="onWindowKeyDown" class="targanchor"><span class="b">onWindowKeyDown(key, shift)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onWindowKeyDown"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">key</td><td class="tagattribname">キーダウンした仮想キーコード。</td></tr>
<tr><td class="tagattribalias">shift</td><td class="tagattribname">同時に押されていたキー。</td></tr>
</table>
</div></div>

<h1><a name="onWindowKeyUp" id="onWindowKeyUp" class="targanchor"><span class="b">onWindowKeyUp(key, shift)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onWindowKeyUp"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">key</td><td class="tagattribname">キーアップした仮想キーコード。</td></tr>
<tr><td class="tagattribalias">shift</td><td class="tagattribname">同時に押されていたキー。</td></tr>
</table>
</div></div>

<h1><a name="onWindowClose" id="onWindowClose" class="targanchor"><span class="b">onWindowClose(window)</span></h1>
<div class="para"><div><table class="tagparams" frame="box" rules="all" summary="onWindowClose"><thead><tr><td>引数</td><td>説明</td></tr></thead><tbody>
<tr><td class="tagattribalias">window</td><td class="tagattribname">ウインドウオブジェクト。</td></tr>
</table>
</div></div>

	<script type="text/javascript" charset="Shift_JIS" src="documentid.js" ></script>
	<script type="text/javascript" charset="Shift_JIS" src="postcontent.js" ></script>
</body>
</html>
